# 动态排行榜生成器

一个纯前端的动态排行榜动画生成工具，支持视频录制和下载，方便分享到视频号等平台。

## 📋 项目概述

**动态排行榜生成器** 是一个基于 Web 的工具，用于创建动态排序动画的排行榜并录制为视频。项目采用纯前端技术实现，无需后端服务器，直接在浏览器中运行。

### 核心特性
- 🎬 **视频录制下载**：支持 MP4/WebM 格式视频导出，方便分享
- 🎨 **精美视觉效果**：前三名特殊样式、随机渐变色、多种动画类型可选
- 🎭 **6种动画类型**：挤压式、淡入式、横向滑入式、缩放弹跳式、翻转卡片式、升降机式
- 📱 **左右布局设计**：左侧配置，右侧预览，高度占满屏幕
- 🚀 **零依赖**：仅使用原生 HTML5、CSS3、JavaScript
- 💾 **多数据格式支持**：JSON 数组/对象格式，支持文件上传和文本输入
- 🎯 **默认数据预设**：内置十二星座数据，一键体验

## ✨ 核心功能

### 数据输入功能
- **双模式数据输入**：
  - 📝 **文本输入**：直接粘贴 JSON 格式数据
  - 📁 **文件上传**：支持拖拽或点击上传 JSON/TXT 文件
- **默认数据**：内置十二星座数据，方便快速体验
- **智能数据解析**：
  - 支持两种 JSON 格式：数组格式 `[{name: "xxx", value: 123}]` 和对象格式 `{"name": 123}`
  - 自动识别字段别名（支持 name/label/title，value/score）
  - 数据验证和过滤（过滤无效值和负值）

### 动画效果功能
- **6种动画类型可选**：
  | 动画类型 | 效果描述 | 适用场景 |
  |---------|---------|---------|
  | 🎯 **挤压式** | 新条目从顶部滑入，挤压已有条目向下 | 经典排行榜效果 |
  | 💫 **淡入式** | 条目固定位置，逐个淡入显示 | 简洁优雅的数据展示 |
  | 🚀 **横向滑入式** | 条目从左侧滑入 | 充满动感的现代风格 |
  | 🎪 **缩放弹跳式** | 条目从中心缩放+弹性出现 | 活泼有趣的展示效果 |
  | 🃏 **翻转卡片式** | 条目以3D翻转方式出现 | 精致的卡片翻转效果 |
  | 🛗 **升降机式** | 条目从下方弹跳升起 | 像电梯一样的趣味效果 |

- **Canvas 渲染动画**：
  - 从第12名（最小值）到第1名（最大值）的逐个出现动画
  - 使用 requestAnimationFrame 实现流畅的 30fps 动画
  - 每种动画类型都有独特的缓动函数（easeOut、elasticOut、easeOutBounce 等）

- **视觉设计**：
  - 前三名特殊样式：金牌🥇、银牌🥈、铜牌🥉
  - 其他排名：每次运行随机生成不同颜色（完全随机 HSL）
  - 值越小透明度越高（0.5 - 1.0）
  - 条形图宽度根据数值比例自动计算（最大值 100%）
  - 分数显示在条形图右侧
  - 渐变背景和阴影效果

### 视频录制功能
- **Canvas 流录制**：直接从 Canvas 捕获流进行录制
- **多格式支持**：
  - 优先使用 MP4 格式
  - 不支持时自动回退到 WebM
- **高画质**：8Mbps 码率，2x 分辨率缩放
- **文件命名**：自动生成包含标题和时间戳的文件名

### 设置配置功能
- **动画类型选择**：6种动画效果可选，满足不同场景需求
- **排行榜标题**：可自定义显示标题（默认：十二星座动态排行榜）
- **动画速度控制**：条形图间隔时间调节（0.1-2秒，默认0.5秒）
- **条形图高度**：可调整代码中的 `itemHeight` 值（默认35px）

### 用户界面功能
- **左右分栏布局**：
  - 左侧：配置面板（数据输入、设置、按钮）
  - 右侧：预览面板（排行榜展示）
  - 高度占满屏幕，整体居中
- **响应式设计**：适配各种屏幕尺寸，小屏幕自动切换为垂直布局
- **Tab 切换界面**：清晰的数据输入方式切换
- **视觉反馈**：按钮悬停效果、文件上传状态提示、录制状态指示
- **暗色主题**：排行榜展示区域采用深色渐变背景，增强视觉对比
- **竖屏比例**：9:16 设计，适合手机短视频平台

## 🛠 技术栈

### 前端技术
- **HTML5**：语义化标签，Canvas 元素
- **CSS3**：
  - Flexbox 布局（左右分栏）
  - 渐变背景（linear-gradient）
  - 动画关键帧（@keyframes）
  - 响应式设计（媒体查询）
- **JavaScript（ES6+）**：
  - 面向对象编程（Class 语法）
  - Promise 异步处理
  - Canvas 2D API 绘制
  - MediaRecorder API 录制视频
  - requestAnimationFrame 动画循环
  - File API（文件读取）

## 📁 项目结构

```
dynamic-ranking/
├── index.html          # 主页面文件
├── css/
│   └── style.css      # 样式文件
├── js/
│   └── app.js         # 主 JavaScript 逻辑
└── README.md          # 项目说明文档
```

## 🚀 使用方法

### 基本操作流程

1. **查看默认数据**：打开页面即可看到十二星座的默认数据

2. **配置设置**（可选）：
   - 选择动画类型（6种可选）
   - 修改排行榜标题
   - 调整条形图间隔时间

3. **运行动画**：
   - 点击"运行动画"按钮
   - 观看从第12名到第1名的动态排序过程
   - 系统自动开始录制

4. **下载视频**：
   - 录制完成后，"下载视频"按钮自动启用
   - 点击按钮下载 MP4 格式视频

### 自定义数据

在左侧文本框中输入自己的数据，格式如下：

```json
[
  {"name": "白羊座", "value": 856},
  {"name": "金牛座", "value": 942},
  {"name": "双子座", "value": 723},
  {"name": "巨蟹座", "value": 1089},
  {"name": "狮子座", "value": 1156},
  {"name": "处女座", "value": 678},
  {"name": "天秤座", "value": 934},
  {"name": "天蝎座", "value": 1212},
  {"name": "射手座", "value": 789},
  {"name": "摩羯座", "value": 1100},
  {"name": "水瓶座", "value": 867},
  {"name": "双鱼座", "value": 945}
]
```

### 支持的字段别名

- **名称字段**：`name`、`label`、`title`
- **数值字段**：`value`、`score`

## 💻 运行方式

### 本地运行
1. 下载项目文件到本地
2. 使用浏览器直接打开 `index.html` 文件
3. 开始使用动态排行榜生成器

### 在线使用
可以将项目部署到任何静态网站托管服务（如 GitHub Pages、Netlify、Vercel 等）

## 🎨 设计特点

### 视觉效果
- **左右分栏**：配置区和预览区清晰分离
- **随机颜色**：每次运行生成不同的颜色组合
- **透明度映射**：数值越小，条形图越透明
- **渐变设计**：使用 CSS 和 Canvas 渐变创建现代视觉效果
- **阴影和圆角**：增强 UI 元素的深度感和美观度

### 用户体验
- **直观操作**：清晰的标签页和按钮设计
- **即时反馈**：文件上传状态、录制状态、错误提示
- **全屏展示**：排行榜占满右侧面板，便于预览
- **响应式布局**：自动适配不同设备屏幕

## 🎯 适用场景

1. **数据可视化**：统计排名展示
2. **比赛排名**：体育比赛、游戏比赛排名
3. **成绩展示**：考试成绩、工作绩效排名
4. **社交媒体内容**：创建吸引人的排名动画视频
5. **视频号内容**：适合短视频平台的竖屏 9:16 视频
6. **教育演示**：排名变化过程展示

## 🔧 自定义开发

### 修改条形图高度
编辑 `js/app.js` 文件第 490 行：
```javascript
const itemHeight = 40; // 改为你想要的值，如 30、35 等
```

### 修改样式
编辑 `css/style.css` 文件：
- 修改颜色主题
- 调整动画参数
- 定制布局样式

### 扩展功能
编辑 `js/app.js` 文件：
- 添加新的数据格式支持
- 扩展动画效果
- 增加新功能模块

## 📊 技术实现细节

### 核心算法

1. **随机颜色生成**
   ```javascript
   // 完全随机的 HSL 颜色，每次运行都不一样
   generateRandomColor() {
     const hue = Math.floor(Math.random() * 360);
     const saturation = 70 + Math.floor(Math.random() * 20);
     const lightness = 50 + Math.floor(Math.random() * 15);
     return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
   }
   ```

2. **透明度计算**
   ```javascript
   // 值越小透明度越高
   const valueRatio = (item.value - minValue) / (maxValue - minValue || 1);
   item.opacity = 0.5 + valueRatio * 0.5;
   ```

3. **动态动画系统**
   - 使用 requestAnimationFrame 实现 30fps 动画循环
   - 6种动画类型，每种都有独特的缓动函数和变换效果
   - 挤压式：新项目从顶部滑入，挤压已有项目向下
   - 淡入式：固定位置，透明度从0到1变化
   - 横向滑入式：从左侧(-400px)滑入到目标位置
   - 缩放弹跳式：从中心scale(0)弹跳到scale(1)
   - 翻转卡片式：绕Y轴从180°旋转到0°，配合透明度变化
   - 升降机式：从下方(600px)弹跳上升到目标位置

4. **视频录制**
   - 使用 `canvas.captureStream(30)` 获取 Canvas 流
   - 使用 `MediaRecorder` 录制视频
   - 优先尝试 MP4 格式，不支持则使用 WebM

### 主要类和方法

- **`DynamicRanking` 类**：主控制器类
  - `parseData()`：数据解析和验证
  - `runAnimation()`：运行动画主流程
  - `runCanvasAnimation()`：Canvas 动画渲染
  - `initCanvas()`：初始化 Canvas
  - `prepareAnimationData()`：准备动画数据
  - `clearCanvas()`：清空 Canvas
  - `drawTitle()`：绘制标题
  - `drawItem()`：绘制单个条目
  - `startRecording()`：开始录制
  - `stopRecording()`：停止录制
  - `downloadVideo()`：下载视频
  - `getInitialState()`：根据动画类型获取初始状态
  - `updateAnimationState()`：根据动画类型更新项目状态
  - `updateSqueezeAnimation()`：挤压式动画更新
  - `updateFadeAnimation()`：淡入式动画更新
  - `updateSlideAnimation()`：横向滑入式动画更新
  - `updateScaleAnimation()`：缩放弹跳式动画更新
  - `updateFlipAnimation()`：翻转卡片式动画更新
  - `updateElevatorAnimation()`：升降机式动画更新

## 📝 注意事项

1. **浏览器兼容性**：
   - 支持现代浏览器（Chrome、Firefox、Safari、Edge）
   - MP4 格式支持有限，不支持时自动使用 WebM

2. **数据安全**：所有数据处理都在客户端进行，无数据上传到服务器

3. **性能考虑**：
   - 建议一次处理不超过 50 个数据项以获得最佳动画效果
   - 录制过程依赖浏览器性能，建议使用 Chrome/Edge

4. **视频格式**：
   - 优先使用 MP4 格式
   - 如浏览器不支持，会下载 WebM 格式
   - 可使用视频编辑软件转换为其他格式

## 📄 许可证

本项目为开源项目，可用于个人和商业用途。

---

**项目状态**：功能完整，稳定可用
**最后更新**：2026年2月1日
**版本**：3.0.0
