# 动态排行榜生成器 - 项目功能说明

## 项目概述

动态排行榜生成器是一个纯前端Web应用，用于生成美观的动态排行榜动画，并支持将动画导出为视频文件。

## 核心功能

### 1. 数据输入

#### 1.1 文本输入模式
- 支持直接在文本框中输入JSON格式数据
- 支持两种JSON格式：
  - **对象数组格式**：
    ```json
    [
      {"name": "白羊座", "value": 100},
      {"name": "金牛座", "value": 200}
    ]
    ```
  - **键值对格式**：
    ```json
    {
      "白羊座": 100,
      "金牛座": 200
    }
    ```

#### 1.2 文件上传模式
- 支持 `.json` 和 `.txt` 格式文件上传
- 支持拖拽上传功能
- 上传后自动显示文件加载状态

### 2. 数据解析

#### 2.1 支持的字段
- `name` / `label` / `title` - 项目名称
- `value` / `score` - 数值

#### 2.2 解析规则
- 自动识别并转换JSON格式
- 无效数据自动过滤
- 数值自动转换为浮点数

### 3. 排行榜展示

#### 3.1 排序规则
- 数据按数值从小到大排序
- 排行榜从上到下显示：第1名（最大值）→ 第N名（最小值）

#### 3.2 视觉设计
- **前三名特殊样式**：
  - 第1名：金色渐变背景 + 🥇 奖牌图标
  - 第2名：银色渐变背景 + 🥈 奖牌图标
  - 第3名：铜色渐变背景 + 🥉 奖牌图标
- 其他排名：半透明白色背景 + 数字排名
- 条形图宽度按比例显示（相对最大值的百分比）
- 竖屏比例展示容器（9:16）

### 4. 动画效果

#### 4.1 飞入动画
- 条形图从画面左侧外部飞入
- 带有过冲回弹效果（easeOutBack缓动函数）
- 每个条目逐个显示，从最低排名开始

#### 4.2 动画时长设置
- 可调节范围：0.5秒 ~ 10秒
- 步进：0.5秒
- 默认：3秒

### 5. 视频导出

#### 5.1 录制功能
- 使用 HTML5 Canvas API 和 MediaRecorder API
- 支持 60fps 录制
- 高清渲染（2x scale）

#### 5.2 支持的格式
- WebM (VP9/VP8)
- MP4（按浏览器支持情况自动选择）

#### 5.3 导出流程
1. 点击"导出视频"按钮
2. 重新播放排行榜动画
3. 同时录制Canvas画面
4. 自动下载视频文件

## 技术栈

| 技术 | 用途 |
|------|------|
| HTML5 | 页面结构 |
| CSS3 | 样式与动画 |
| Vanilla JavaScript | 逻辑实现 |
| Canvas API | 视频渲染 |
| MediaRecorder API | 视频录制 |

## 文件结构

```
dynamic-ranking/
├── index.html          # 主页面
├── css/
│   └── style.css       # 样式表
├── js/
│   └── app.js          # 主逻辑
└── PROJECT_FUNCTIONALITY.md  # 本文档
```

## 核心类：DynamicRanking

### 主要方法

| 方法 | 功能 |
|------|------|
| `handleTabSwitch()` | 切换文本输入/文件上传标签页 |
| `handleFileUpload()` | 处理文件上传 |
| `handleFileDrop()` | 处理拖拽文件 |
| `parseData()` | 解析输入数据 |
| `runAnimation()` | 运行排行榜动画 |
| `animateRanking()` | DOM动画渲染 |
| `exportVideo()` | 导出视频 |
| `recordAnimation()` | Canvas录制动画 |
| `drawRankingItem()` | 绘制单个排行项目 |

## 特性亮点

1. **纯前端实现** - 无需后端服务器，可直接在浏览器中运行
2. **响应式设计** - 支持移动端和桌面端
3. **错误处理** - 友好的错误提示Toast
4. **XSS防护** - HTML转义处理
5. **动画平滑** - 使用CSS过渡和requestAnimationFrame
