<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>动态排行榜生成器</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="main-container">
        <!-- 左侧配置区域 -->
        <div class="config-panel">
            <h1>动态排行榜生成器</h1>

            <!-- 可滚动主体区域：把输入与设置放入这里，以避免面板超高 -->
            <div class="config-body">
            <!-- 数据输入区域 -->
            <div class="input-section">
                <div class="tabs">
                    <button class="tab-button active" data-tab="text">文本输入</button>
                    <button class="tab-button" data-tab="file">文件上传</button>
                </div>

                <!-- 文本输入标签页 -->
                <div class="tab-content active" id="text-tab">
                    <label for="data-input" style="display:block;margin-bottom:8px;color:#4a5568;font-weight:600;">数据（JSON格式）：</label>
                    <textarea id="data-input" rows="12">[
  {"name": "白羊座", "value": 856},
  {"name": "金牛座", "value": 942},
  {"name": "双子座", "value": 723},
  {"name": "巨蟹座", "value": 1089},
  {"name": "狮子座", "value": 1156},
  {"name": "处女座", "value": 678},
  {"name": "天秤座", "value": 934},
  {"name": "天蝎座", "value": 1212},
  {"name": "射手座", "value": 789},
  {"name": "摩羯座", "value": 1100},
  {"name": "水瓶座", "value": 867},
  {"name": "双鱼座", "value": 945}
]</textarea>
                </div>

                <!-- 文件上传标签页 -->
                <div class="tab-content" id="file-tab">
                    <div class="file-upload">
                        <input type="file" id="file-input" accept=".json,.txt">
                        <label for="file-input" class="file-label">
                            <span>点击或拖拽文件到此处</span>
                            <small>支持 JSON 和 TXT 格式</small>
                        </label>
                    </div>
                    <div id="file-info" class="file-info"></div>
                </div>
            </div>

            <!-- 设置区域：左列为四个主要配置，右列放其余高级配置；底部按钮放入该容器 -->
            <div class="settings-section">
                <div class="settings-columns">
                    <div class="settings-left">
                        <div class="settings-header">基础配置</div>
                        <div class="setting-item stack"><label for="title-input">排行榜标题</label><input type="text" id="title-input" value="十二星座动态排行榜" placeholder="请输入标题"></div>
                        <div class="setting-item stack"><label for="animation-type">动画类型</label><select id="animation-type"><option value="squeeze">🎯 挤压式</option><option value="fade">💫 淡入式</option><option value="slide">🚀 横向滑入式</option><option value="scale">🎪 缩放弹跳式</option><option value="flip">🃏 翻转卡片式</option><option value="elevator">🛗 升降机式</option></select></div>
                        <div class="setting-item stack"><label for="animation-duration">条形图间隔时间（秒）</label><input type="number" id="animation-duration" value="0.5" min="0.1" max="2" step="0.1"></div>
                        <div class="setting-item"><label for="fireworks-enable">烟花效果</label><div class="checkbox-group"><input type="checkbox" id="fireworks-enable" checked><label for="fireworks-enable">启用前三名烟花</label></div></div>

                        <!-- 新增：背景图上传与透明度控制 -->
                        <div class="setting-item stack">
                            <label for="bg-image-input">背景图</label>
                            <input type="file" id="bg-image-input" accept="image/*">
                        </div>
                        <div class="setting-item">
                            <label for="bg-opacity">背景图透明度</label>
                            <input type="range" id="bg-opacity" min="0" max="1" step="0.01" value="1">
                        </div>

                    </div>
                    <div class="settings-right">
                        <div class="advanced-panel">
                            <div class="settings-header">
                                高级配置
                                <button id="advanced-toggle" class="advanced-toggle" aria-expanded="false" aria-controls="advanced-content">展开</button>
                            </div>
                            <div id="advanced-content" class="advanced-content">
                                <div class="setting-item"><label for="fireworks-duration">烟花持续（秒）</label><input type="number" id="fireworks-duration" value="3" min="0.5" max="10" step="0.5"></div>
                                <div class="setting-item"><label for="fireworks-density">烟花密度（基数）</label><input type="number" id="fireworks-density" value="10" min="8" max="128" step="1"></div>
                                <div class="setting-item"><label for="fireworks-trail">尾迹长度</label><input type="number" id="fireworks-trail" value="20" min="4" max="80" step="1"></div>
                                <div class="setting-item"><label for="fireworks-glow">光晕强度（0-1）</label><input type="number" id="fireworks-glow" value="0.1" min="0" max="1" step="0.1"></div>
                                <div class="setting-item"><label for="fireworks-speed">碎片速度倍数</label><input type="number" id="fireworks-speed" value="1" min="0.4" max="2" step="0.1"></div>
                                <div class="setting-item"><label for="fireworks-core-ratio">核心亮点占比</label><input type="number" id="fireworks-core-ratio" value="0.06" min="0" max="0.5" step="0.01"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- /.settings-section -->
            </div> <!-- /.config-body -->

            <!-- 控制按钮：作为 config-panel 的独立一行，保证始终可见 -->
            <div class="panel-controls">
                <div class="controls">
                    <button id="run-animation" class="primary-button">运行动画</button>
                    <button id="preview-animation" class="primary-button preview-btn">预览动画</button>
                    <button id="download-video" class="secondary-button" disabled>下载视频</button>
                </div>
            </div>

            <!-- 录制状态提示 -->
            <div id="recording-status" class="recording-status" style="display: none;">
                <span class="recording-dot"></span>
                正在录制视频...
            </div>
        </div>

        <!-- 右侧展示区域 -->
        <div class="preview-panel">
            <!-- 排行榜展示区域 -->
            <div class="ranking-container" id="ranking-container">
                <!-- 背景图 DOM 预览（仅用于页面预览），由 JS 控制显示/隐藏与透明度 -->
                <img id="ranking-bg-image" alt="背景图" style="position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:none; z-index:0; pointer-events:none;" />
                <canvas id="ranking-canvas"></canvas>
                <!-- DOM 版本用于显示（Canvas用于录制） -->
                <div id="ranking-title" class="ranking-title" style="position: absolute; top: 30px; left: 0; right: 0; text-align: center;"></div>
                <div id="ranking-content" style="position: absolute; top: 120px; left: 20px; right: 20px; bottom: 20px;">
                    <div class="empty-state">
                        <p>点击"运行动画"开始演示</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>